1. 먼저 필터링하고자 하는 국가에 속하면 1 아니면 0인 성분을 가진 열벡터 v를 만든다.
2. Jur = v @ v.T 로 국가 행렬 Jur를 만든다. (v.T는 v의 전치행렬) → (i,j) 성분이 i와 j가 같은 국가에 속하면 1, 아니면 0인 행렬
3. 직간접지배행렬을 I라고 했을 때 I *(hadamard) Jur 로 국가내 직간접지배행렬을 만든다.
4. 행렬축소(X): 3번에서 만든 행렬에서 0 성분인 행과 열을 제거하여 축소된 행렬 X를 만든다.(모든 k에 대해 (i,k) 성분과 (k,j) 성분이 0이면 i,j 행과 열을 제거)
5. 직접지배역산(D) = X - X^2
6. D를 바탕으로 다시 Tier, Depth, Terminal Nodes 개수를 계산하여 레이아웃을 정한다.